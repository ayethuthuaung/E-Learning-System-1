<div class="min-h-screen bg-gray-100 flex flex-col">
  <app-instructor-navbar (toggleSidebarEvent)="toggleSidebar()"></app-instructor-navbar>
  <div class="flex flex-1">
    <app-instructor-sidebar [isSidebarOpen]="isSidebarOpen"></app-instructor-sidebar>

    <main class="flex-1 p-6">
      <section>
        <div class="flex border-b">

          <button (click)="goBack()" class="py-2 px-4 text-sm font-medium text-logo-blue hover:text-blue-800 focus:outline-none flex items-center">
            <i class="fas fa-arrow-left mr-2"></i> Go Back
          </button>
          
          <button
            class="py-2 px-4 text-md font-medium text-logo-blue hover:text-blue-800 focus:outline-none"
            [ngClass]="{ 'border-b-2 border-blue-600': activeTab === 'createLesson' }"
            (click)="setActiveTab('createLesson')"
          >
            Create Lesson
          </button>
          <button
            class="py-2 px-4 text-md font-medium text-logo-blue hover:text-blue-800 focus:outline-none"
            [ngClass]="{ 'border-b-2 border-blue-600': activeTab === 'createExam' }"
            (click)="setActiveTab('createExam')"
          >
            Create Exam
          </button>
        </div>

        

        <div *ngIf="activeTab === 'createLesson'" class="p-4">
          <div class="flex flex-col items-center justify-center light">
            <div class="w-full max-w-md bg-white rounded-lg shadow-md p-6">
              <form class="flex flex-col" #courseForm="ngForm" (ngSubmit)="onSubmit(courseForm)" method="post">
                <input
                  type="text"
                  class="bg-gray-100 text-gray-800 border-0 rounded-md p-2 mb-4 focus:bg-gray-200 focus:outline-none focus:ring-1 focus:ring-blue-500 transition ease-in-out duration-150"
                  id="name"
                  name="name"
                  [(ngModel)]="course.name"
                  required
                  (input)="validateCourseName(course.name)"
                  placeholder="Lesson Title"
                />

                <div *ngFor="let module of modules; let i = index" class="mb-4">
                  <div class="flex items-center mb-2">
                    <input
                      type="text"
                      class="bg-gray-100 text-gray-800 border-0 rounded-md p-2 focus:bg-gray-200 focus:outline-none focus:ring-1 focus:ring-blue-500 transition ease-in-out duration-150 flex-grow"
                      [(ngModel)]="module.name"
                      name="moduleName{{ i }}"
                      required
                      placeholder="Module Name"
                    />
                    <button
                      type="button"
                      class="ml-2 text-red-400 hover:text-red-600 transition ease-in-out duration-150"
                      (click)="removeModule(i)"
                    >
                      <i class="fas fa-trash"></i>
                    </button>
                  </div>
                  <input
                    type="file"
                    class="bg-gray-100 text-gray-800 border-0 rounded-md p-2 focus:bg-gray-200 focus:outline-none focus:ring-1 focus:ring-blue-500 transition ease-in-out duration-150 w-full"
                    (change)="onFileSelected($event, i)"
                    name="moduleUrl{{ i }}"
                    required
                  />
                </div>

                <div class="flex space-x-2">
                  <button
                    type="button"
                    class="bg-logo-blue from-dark-blue to-logo-blue text-white font-bold py-2 px-4 rounded-md mt-4 hover:bg-dark-blue hover:to-logo-blue transition ease-in-out duration-150"
                    (click)="addModule()"
                  >
                    Add Module
                  </button>

                  <button
                    type="submit"
                    class="bg-logo-blue from-dark-blue to-logo-blue text-white font-bold py-2 px-4 rounded-md mt-4 hover:bg-dark-blue hover:to-logo-blue transition ease-in-out duration-150"
                    [disabled]="nameDuplicateError"
                  >
                    Submit
                  </button>
                </div>
              </form>
            </div>
          </div>
        </div>

        <div *ngIf="activeTab === 'createExam'" class="p-4 bg-gray-100 min-h-screen flex flex-col items-center">
          <div class="w-full max-w-xl bg-white rounded-lg shadow-md p-6">
            <input type="text" [(ngModel)]="examTitle" placeholder="Exam Title" class="bg-gray-100 form-input w-full mb-4 px-4 py-2 border rounded">
            <textarea [(ngModel)]="examDescription" placeholder="Exam Description" class="bg-gray-100 form-textarea w-full mb-4 px-4 py-2 border rounded"></textarea>
            
            <!-- <textarea [(ngModel)]="formDescription" placeholder="" class="form-textarea w-full mb-4 px-4 py-2 border rounded"></textarea> -->
     
            <div *ngFor="let question of questions; let qIndex = index" class="mb-6">
              <div class="flex items-center">
              <input type="text" [(ngModel)]="question.text" placeholder="Question Text" class="bg-gray-100 form-input w-full mb-2 px-4 py-2 border rounded">
              <button (click)="deleteNewQuestion(qIndex)" class="ml-2 text-gray-500 hover:text-red-600 transition ease-in-out duration-150">
                <i class="fas fa-trash fa-lg"></i>
              </button> 
              </div>

              <div class="flex items-center mb-2">
              <select [(ngModel)]="question.type" class="bg-gray-100 form-select w-1/3 mb-2 px-4 py-2 border rounded">
                <option value="multiple-choice">Multiple Choice</option>
                <option value="checkbox">Checkbox</option>
              </select>
              <input type="text" [(ngModel)]="question.marks" placeholder="Marks" class="bg-gray-100 form-input w-1/3 mb-2 ml-4 px-4 py-2 border rounded">
            </div>
          
              <div class="mb-4">
                <div *ngFor="let option of question.options; let oIndex = index" class="flex items-center mb-2">
                  <input type="text" [(ngModel)]="option.label" placeholder="Option Label" class="bg-gray-100 form-input w-full mb-2 px-4 py-2 border rounded mr-2">
                  
                  <input *ngIf="question.type === 'multiple-choice'" 
                         type="radio" 
                         [id]="'q' + qIndex + 'o' + oIndex" 
                         [name]="'question' + qIndex" 
                         [checked]="option.isAnswered" 
                         (change)="selectOption(qIndex, oIndex)"
                         class="mr-2">
                  <input *ngIf="question.type === 'checkbox'" 
                         type="checkbox" 
                         [id]="'q' + qIndex + 'o' + oIndex" 
                         [(ngModel)]="option.isAnswered"
                         class="mr-2">
                  
                  <div *ngIf="showResults" class="ml-2">
                    <span *ngIf="option.isCorrect" class="text-green-500">Correct</span>
                    <span *ngIf="!option.isCorrect && option.isAnswered" class="text-red-500">
                      Incorrect - Correct answer: {{ question.correctAnswer }}
                    </span>
                  </div>
                </div>
              </div>
          
                           
              <button (click)="addOption(qIndex)" class="bg-blue-500 text-white px-4 py-2 rounded mb-2">Add Option</button>
            </div>
            
            <button (click)="addQuestion()" class="bg-green-500 text-white px-4 py-2 rounded mb-4">Add Question</button>
            <button (click)="onSubmitExam(examForm)" class="bg-indigo-500 text-white px-4 py-2 rounded">Submit Form</button>
          </div>
        </div>
        
      </section>
    </main>
  </div>
</div>
